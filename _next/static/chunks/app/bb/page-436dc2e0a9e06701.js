(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8465],{63353:function(e,n,t){Promise.resolve().then(t.bind(t,62605))},62605:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return y}});var i=t(57437),a=t(21925),r=t(70626),l=t(84534),o=t(57622),s=t(2265),u=t(93551),c=t.n(u),d=t(72544),h=t(49084),g=t(83519),f=t(96733);let w={cs:.2,ch:1,walkableSlopeAngle:0,walkableHeight:0,walkableClimb:0,walkableRadius:1,maxEdgeLen:12,maxSimplificationError:1.3,minRegionArea:8,mergeRegionArea:20,maxVertsPerPoly:6,detailSampleDist:6,detailSampleMaxError:15,borderSize:0,tileSize:10};function p(e,n,t){let i=(0,d.NR)("box"+Math.random(),{width:n.x,height:n.y,depth:n.z},t);return i.position=e,i}var m=t(53485);let P={radius:.1,height:.2,maxAcceleration:1e3,maxSpeed:10,collisionQueryRange:.5,pathOptimizationRange:0,separationWeight:1};var v=(0,s.forwardRef)(function(e,n){let{name:t,size:r=1,crowd:o,navigation:u}=e,c=t||"cat"+Math.random().toString(36).substring(2,15),d=(0,a.$rd)(),h=(0,s.useRef)(null);async function g(){var e;let{loop:n=!0,delay:t=100,count:i=0,onEnd:a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};null===(e=h.current)||void 0===e||e.playAnimation(40,45,!a,t,null!=a?a:()=>{})}async function f(){var e;let{loop:n=!0,delay:t=100,count:i=0,onEnd:a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};null===(e=h.current)||void 0===e||e.playAnimation(15,18,!a,t,null!=a?a:()=>{})}async function w(){var e;let{loop:n=!0,delay:t=100,count:i=0,onEnd:a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};null===(e=h.current)||void 0===e||e.playAnimation(10,14,!a,t,null!=a?a:()=>{})}async function p(){var e;let{loop:n=!0,delay:t=100,count:i=0,onEnd:a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};null===(e=h.current)||void 0===e||e.playAnimation(20,24,!a,t,null!=a?a:()=>{})}async function v(){var e;let{loop:n=!0,delay:t=100,count:i=0,onEnd:a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};null===(e=h.current)||void 0===e||e.playAnimation(25,27,!a,t,null!=a?a:()=>{})}async function b(){var e;let{loop:n=!0,delay:t=100,count:i=0,onEnd:a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};null===(e=h.current)||void 0===e||e.playAnimation(30,36,!a,t,null!=a?a:()=>{})}async function x(){var e;let{loop:n=!0,delay:t=100,count:i=0,onEnd:a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};null===(e=h.current)||void 0===e||e.playAnimation(0,9,!a,t,null!=a?a:()=>{})}return(0,s.useEffect)(()=>{let e;if(o){let n=new m.Y(c+"_transform");e=o.addAgent({x:0,y:0,z:0},P,n)}return()=>{null==o||o.removeAgent(e)}},[o,u,h.current]),(0,s.useEffect)(()=>{function e(){for(let e of o.getAgents())o.getAgentPositionToRef(e,h.current.position)}return h.current&&d.onBeforeRenderObservable.add(e),()=>{d.onBeforeRenderObservable.remove(e)}},[o,u,h.current]),(0,s.useEffect)(()=>{function e(e){if(32===e.type){let{pointerX:e,pointerY:n}=d,t=d.pickSprite(e,n);if(t.hit&&t.pickedSprite===h.current){(Math.random()>.5?p:v)({delay:500,onEnd:()=>{f()}});return}let i=d.pick(e,n);i.hit&&i.pickedMesh&&(console.log(o,i,u.getClosestPoint(i.pickedPoint)),o.agentGoto(0,u.getClosestPoint(i.pickedPoint)))}}return d.onPointerObservable.add(e),()=>{d.onPointerObservable.remove(e)}},[d]),(0,s.useImperativeHandle)(n,()=>({move:g,idle:f,sleep:w,clean:p,clean2:v,chick:b,eat:x,get sprite(){return h.current}}),[]),(0,i.jsx)("spriteManager",{name:c+"_spriteManager",imgUrl:"/cat/_next/static/media/sprite.ab9edf41.png",cellSize:256,capacity:1,isPickable:!0,children:(0,i.jsx)("sprite",{name:c+"_sprite",ref:h,cellIndex:16,position:new l.P(0,0,0),width:r,height:r,isPickable:!0})})});function b(){return(0,i.jsx)("plane",{name:"bg",width:32,height:65.5,position:new l.P(0,-1,0),rotation:new l.P(Math.PI/2,0,0),children:(0,i.jsx)("standardMaterial",{name:"bg-material",children:(0,i.jsx)("texture",{name:"bg-texture",url:"/cat/_next/static/media/ground-texture.dbd26a35.png",assignTo:"emissiveTexture"})})})}function x(){let e=function(e){let[n,t]=(0,s.useState)(null);return(0,s.useEffect)(()=>{let n,i;return e&&c()().then(a=>{n=new o.P(a);let r=(0,h.$6)("ground",{width:32,height:64},e);r.position.y=-1;let s=f.Kj.MergeMeshes([p(new l.P(0,0,14),new l.P(32,8,1),e),p(new l.P(-13,0,12),new l.P(4,4,4),e),p(new l.P(13,0,12),new l.P(4,4,4),e),p(new l.P(-10,0,5),new l.P(11,4,6),e),p(new l.P(9.5,0,3.5),new l.P(8,4,7),e),p(new l.P(-8.5,0,-3),new l.P(14,4,5),e),p(new l.P(-8.5,0,-15),new l.P(14,4,6),e),p(new l.P(10,0,-9),new l.P(11,4,4),e),p(new l.P(13,0,-14),new l.P(6,4,3),e),p(new l.P(11,0,-19),new l.P(9,4,2),e),p(new l.P(-6,0,-30),new l.P(18,4,2),e),p(new l.P(15,0,-27),new l.P(2,4,3),e),p(new l.P(13,0,-30),new l.P(6,4,2),e),r]),u=new g.K("block_mat",e);u.alpha=0,s.material=u,n.createNavMesh([s],w),t({crowd:i=n.createCrowd(5,.3,e),navigation:n})}),()=>{null==i||i.dispose(),null==n||n.dispose(),t(null)}},[e]),n}((0,a.$rd)()),n=(0,s.useRef)(null);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("arcRotateCamera",{name:"camera1",target:l.P.Zero(),alpha:-Math.PI/2,beta:0,radius:76,wheelPrecision:100}),(0,i.jsx)(b,{}),e&&(0,i.jsx)(v,{ref:n,name:"cat0",size:4,crowd:null==e?void 0:e.crowd,navigation:null==e?void 0:e.navigation})]})}function y(){return(0,i.jsx)("div",{className:"w-screen h-screen",children:(0,i.jsx)(a.D4V,{antialias:!0,adaptToDeviceRatio:!0,canvasId:"babylon-canvas",className:"w-full h-full !outline-none",children:(0,i.jsx)(a.xsS,{children:(0,i.jsx)(x,{})})})})}r.Y.LogLevels=0}},function(e){e.O(0,[192,4732,3105,2735,790,3918,1780,2971,2117,1744],function(){return e(e.s=63353)}),_N_E=e.O()}]);